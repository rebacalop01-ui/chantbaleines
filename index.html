<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Phrase Baleine</title>

<style>
body{
  background: linear-gradient(#023047,#219ebc);
  color:white;
  font-family: Arial, sans-serif;
  text-align:center;
  padding:24px;
}

h1{margin-bottom:10px}

button{
  padding:10px 16px;
  margin:6px;
  border-radius:10px;
  border:0;
  cursor:pointer;
  font-size:15px;
}

#sequenceDisplay{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:center;
  margin-top:12px;
}

.bubble{
  background:rgba(255,255,255,0.15);
  padding:8px 14px;
  border-radius:18px;
}

.status{
  margin-top:12px;
  font-size:14px;
  opacity:0.95;
}
</style>
</head>

<body>

<h1>ğŸ‹ Phrase Baleine</h1>

<div>
  <button onclick="addSound('Baleine1')">Baleine 1</button>
  <button onclick="addSound('Baleine2')">Baleine 2</button>
  <button onclick="addSound('Baleine3')">Baleine 3</button>
  <button onclick="addSound('Baleine4')">Baleine 4</button>
  <button onclick="addSound('Baleine5')">Baleine 5</button>
</div>

<div>
  <button onclick="playSequence()">â–¶ Rejouer</button>
  <button onclick="stopAll()">â¹ Stop</button>
  <button onclick="clearSequence()">ğŸ—‘ Effacer</button>
</div>

<div id="status" class="status">Statut : prÃªt</div>

<h3>SÃ©quence :</h3>
<div id="sequenceDisplay">(aucune sÃ©lection)</div>

<!-- AUDIOS LOCAUX (GitHub Pages) -->
<audio id="Baleine1" src="sounds/baleine1.mp3"></audio>
<audio id="Baleine2" src="sounds/baleine2.mp3"></audio>
<audio id="Baleine3" src="sounds/baleine3.mp3"></audio>
<audio id="Baleine4" src="sounds/baleine4.mp3"></audio>
<audio id="Baleine5" src="sounds/baleine5.mp3"></audio>

<script>
let sequence = [];
let activeAudios = [];

const seqEl = document.getElementById("sequenceDisplay");
const statusEl = document.getElementById("status");

function setStatus(text){
  statusEl.textContent = "Statut : " + text;
}

function renderSequence(){
  seqEl.innerHTML = "";
  if(sequence.length === 0){
    seqEl.textContent = "(aucune sÃ©lection)";
    return;
  }
  sequence.forEach((id, i)=>{
    const d = document.createElement("div");
    d.className = "bubble";
    d.textContent = (i+1) + ". " + id;
    seqEl.appendChild(d);
  });
}

function playImmediate(id){
  const tag = document.getElementById(id);
  if(!tag) return;
  const audio = new Audio(tag.src);
  audio.play();
  activeAudios.push(audio);
  audio.onended = () => {
    activeAudios = activeAudios.filter(a => a !== audio);
  };
}

function addSound(id){
  sequence.push(id);
  renderSequence();
  playImmediate(id);
}

function playSequence(){
  if(sequence.length === 0) return;
  let i = 0;
  setStatus("Lecture...");
  function next(){
    if(i >= sequence.length){
      setStatus("Lecture terminÃ©e");
      return;
    }
    playImmediate(sequence[i]);
    const last = activeAudios[activeAudios.length - 1];
    if(last){
      last.onended = () => {
        i++;
        next();
      };
    } else {
      i++;
      next();
    }
  }
  next();
}

function stopAll(){
  activeAudios.forEach(a=>{
    a.pause();
    a.currentTime = 0;
  });
  activeAudios = [];
  setStatus("ArrÃªtÃ©");
}

function clearSequence(){
  sequence = [];
  renderSequence();
  setStatus("SÃ©quence effacÃ©e");
}

renderSequence();
</script>

</body>
</html>
